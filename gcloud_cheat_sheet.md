* [have fun with them](https://cloudplatform.googleblog.com/2016/06/filtering-and-formatting-fun-with.html)
* [projections](https://cloud.google.com/sdk/gcloud/reference/topic/projections)
* [filters](https://cloud.google.com/sdk/gcloud/reference/topic/filters)
* [resource-keys](https://cloud.google.com/sdk/gcloud/reference/topic/resource-keys)
* https://cloud.google.com/sdk/docs/scripting-gcloud

## auth
kubectl uses OAuth token generated by 
* `gcloud config config-helper --format json`
* `gcloud config config-helper --format='value(credential.access_token)'`
* `gcloud auth print-access-token` generates new token

```
gcloud init
gcloud auth list
gcloud auth login
gcloud info

```
## switch gcloud context with gcloud config
```
gcloud config list
gcloud config configurations list
gcloud config set account pythonrocksk8s201702@gmail.com 
gcloud config set project salt-163215
gcloud config set compute/region us-west1
gcloud config set compute/zone us-west1-a
alias demo='gcloud config set account pythonrocksk8s201702@gmail.com && gcloud config set project salt-163215 && gcloud config set compute/region us-west1 && gcloud config set compute/zone us-west1-a'

project_id=$(gcloud config get-value core/project)
project_id=$(gcloud config list project --format='value(core.project)')

cluster=$(gcloud config get-value container/cluster 2> /dev/null)
zone=$(gcloud config get-value compute/zone 2> /dev/null)
project=$(gcloud config get-value core/project 2> /dev/null)

```

## find an instance 
* [filters](https://cloud.google.com/sdk/gcloud/reference/topic/filters)
* [resource-keys](https://cloud.google.com/sdk/gcloud/reference/topic/resource-keys)

```
gcloud compute instances list --project=dev --filter="name~^es"
gcloud compute instances list --project=dev --filter=name:kafka --format="value(name,INTERNAL_IP)"
gcloud compute instances list --filter=tags:kafka-node
gcloud compute instances list --filter='machineType:g1-small'

```
# generate ssh config 
```
gcloud compute config-ssh
```

# kms
```
# list all keyrings 
gcloud kms keyrings list --location global
# list all keys in my_key_ring
gcloud kms keys list --keyring my_key_ring --location global
```

# billing
```
gcloud alpha billing accounts projects link <project_id> --account-id <account_id>
```

## address
```
gcloud compute addresses describe https-lb --global --format json
```
## disk snapshot
```
gcloud compute disks snapshot kafka-data1-1 --async --snapshot-names=kafka-data-1 --project project_a --zone us-west1-a
Use [gcloud compute operations describe URI] command to check the status of the operation(s).
```

## find the forwrading-rules given the dns
```
gcloud compute forwarding-rules list --filter=$(dig +short <dns_name>)
```

## describe a regional forwarding rule
```
gcloud compute forwarding-rules describe my-forwardingrule --region us-central1
```

## describe a global forwarding rule
```
gcloud compute forwarding-rules describe my-http-forwardingrule --global
```
## move instance
`gcloud compute instances move <instance_wanna_move> --destination-zone=us-central1-a --zone=us-central1-c`

## debugging
```
gcloud  compute instances list --log-http
```
## iam
```
gcloud projects get-iam-policy <project_id>
gcloud iam service-accounts list
gcloud iam service-accounts get-iam-policy <sa_email>
```

## instance level metadata
```
curl "http://metadata.google.internal/computeMetadata/v1/instance/?recursive=true&alt=text" -H "Metadata-Flavor: Google"
```

## project level metadata
```
gcloud compute project-info describe
```

## set up application-default
https://developers.google.com/identity/protocols/application-default-credentials set up gcloud auth application-default login

https://cloud.google.com/sdk/docs/release-notes#15000_2017-04-05

gcloud container clusters create|get-credentials will now configure kubectl to use the credentials of the active gcloud account by default, instead of using application default credentials. This requires kubectl 1.6.0 or higher. You can update kubectl by running 
gcloud components update kubectl. If you prefer to use application default credentials to authenticate kubectl to Google Container Engine clusters, you can revert to the previous behavior by setting the container/use_application_default_credentials property:
gcloud config set container/use_application_default_credentials true
```
export CLOUDSDK_CONTAINER_USE_APPLICATION_DEFAULT_CREDENTIALS=true
export GOOGLE_APPLICATION_CREDENTIALS=$HOME/.config/salt-87381ff.json
```
